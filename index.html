<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples Gallery &mdash; FastSRM  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FastSRM : running time and convergence" href="auto_examples/plot_synthetic_toy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> FastSRM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/plot_synthetic_toy.html">FastSRM : running time and convergence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">FastSRM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Examples Gallery</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples-gallery">
<span id="sphx-glr-auto-examples"></span><h1>Examples Gallery<a class="headerlink" href="#examples-gallery" title="Permalink to this headline"></a></h1>
<p>The examples gallery provides working code samples demonstrating what
can be done with the FastSRM library.</p>
<div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates on a very small dataset that the optimal atlas used in FastSRM speeds..."><figure class="align-default" id="id1">
<img alt="FastSRM : running time and convergence" src="_images/sphx_glr_plot_synthetic_toy_thumb.png" />
<figcaption>
<p><span class="caption-text"><a class="reference internal" href="auto_examples/plot_synthetic_toy.html#sphx-glr-auto-examples-plot-synthetic-toy-py"><span class="std std-ref">FastSRM : running time and convergence</span></a></span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-clear"></div><div class="sphx-glr-footer class sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/07fcc19ba03226cd3d83d4e40ec44385/auto_examples_python.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">auto_examples_python.zip</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/6f1e7a639e0699d6164445b55e6c116d/auto_examples_jupyter.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">auto_examples_jupyter.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
<section id="identifiablefastsrm">
<h1>IdentifiableFastSRM<a class="headerlink" href="#identifiablefastsrm" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="py class">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastsrm.identifiable_srm.</span></span><span class="sig-name descname"><span class="pre">IdentifiableFastSRM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prob'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pca</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM" title="Permalink to this definition"></a></dt>
<dd><p>SRM decomposition using a very low amount of memory and computational power thanks to the use of an atlas as described in [Richard2019].</p>
<p>Given multi-subject data, factorize it as a shared response S among all subjects and an orthogonal transform (basis) W per subject:</p>
<div class="math notranslate nohighlight">
\[X_i \approx W_i S, \forall i=1 \dots N\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default=&quot;prob&quot;</em>) – if “prob”, uses Probabilistic SRM
if “det”, uses Deterministic SRM</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of timecourses of the shared coordinates</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) – Number of iterations to perform</p></li>
<li><p><strong>temp_dir</strong> (<em>str</em><em> or </em><em>None</em>) – Path to dir where temporary results are stored. If None temporary results will be stored in memory. This can results in memory errors when the number of subjects and/or sessions is large</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – The number of CPUs to use to do the computation. -1 means all CPUs, -2 all CPUs but one, and so on.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> or </em><em>&quot;warn&quot;</em>) – If True, logs are enabled. If False, logs are disabled. If “warn” only warnings are printed.</p></li>
<li><p><strong>aggregate</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=&quot;mean&quot;</em>) – If “mean”, shared_response is the mean shared response from all subjects. If None, shared_response contains all subject-specific responses in shared space</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Stops if the norm of the gradient falls below tolerance value</p></li>
<li><p><strong>use_pca</strong> (<em>bool</em><em> or </em><em>&quot;auto&quot;</em>) – If True use pca as a preprocessing step.
If “auto”, it is set to True
if n_iter &gt; 1 and n_voxels &gt; 10 * n_timeframes.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>RandomState instance</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Controls the randomness of the initialization.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">`basis_list`</span></span></dt>
<dd><ul class="simple">
<li><p>if basis is a list of array, element i is the basis of subject i</p></li>
<li><p>if basis is a list of str, element i is the path to the basis of subject i that is loaded with np.load yielding an array of shape [n_components, n_voxels].</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[n_components, n_voxels] or list of str</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt><cite>noise_variance</cite><span class="classifier">np array of shape (n_views,)</span></dt><dd><p>Noise variance</p>
</dd>
<dt><cite>source_covariance</cite><span class="classifier">np array of shape (n_components,)</span></dt><dd><p>(Diagonal) Shared response covariance</p>
<p>Note that any call to the clean method erases this attribute</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>References:</strong>
H. Richard, L. Martin, A. Pinho, J. Pillow, B. Thirion, 2019: Fast shared response model for fMRI data (<a class="reference external" href="https://arxiv.org/pdf/1909.12537.pdf">https://arxiv.org/pdf/1909.12537.pdf</a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.add_subjects">
<span class="sig-name descname"><span class="pre">add_subjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.add_subjects" title="Permalink to this definition"></a></dt>
<dd><p>Add subjects to the current fit. Each new basis will be appended at the end of the list of basis (which can be accessed using self.basis)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>shared_response</strong> (<em>list of arrays</em><em>, </em><em>list of list of arrays</em><em> or </em><em>array</em>) – <ul>
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.clean" title="Permalink to this definition"></a></dt>
<dd><p>This erases temporary files and basis_list attribute to free memory. This method should be called when fitted model is not needed anymore.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.fit" title="Permalink to this definition"></a></dt>
<dd><p>Computes basis across subjects from input imgs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Returns the instance itself. Contains attributes listed at the object level.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subjects_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.fit_transform" title="Permalink to this definition"></a></dt>
<dd><p>Computes basis across subjects and shared response from input imgs
return shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None:</em>) – if None imgs[i] will be transformed using basis_list[i]. Otherwise imgs[i] will be transformed using basis_list[subjects_index[i]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>shared_response</strong> –</p>
<ul class="simple">
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays, list of list of arrays or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shared_response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subjects_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sessions_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.inverse_transform" title="Permalink to this definition"></a></dt>
<dd><p>From shared response and basis from training data
reconstruct subject’s data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shared_response</strong> (<em>list of arrays</em><em>, </em><em>list of list of arrays</em><em> or </em><em>array</em>) – <ul>
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None</em>) – if None reconstructs data of all subjects used during train. Otherwise reconstructs data of subjects specified by subjects_indexes.</p></li>
<li><p><strong>sessions_indexes</strong> (<em>list</em><em> or </em><em>None</em>) – if None reconstructs data of all sessions. Otherwise uses reconstructs data of sessions specified by sessions_indexes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>reconstructed_data</strong> –</p>
<ul class="simple">
<li><p>if reconstructed_data is a list of list : element i, j is the reconstructed data for subject subjects_indexes[i] and session sessions_indexes[j] as an np array of shape n_voxels, n_timeframes</p></li>
<li><p>if reconstructed_data is a list : element i is the reconstructed data for subject subject_indexes[i] as an np array of shape n_voxels, n_timeframes</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of arrays or list of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastsrm.identifiable_srm.IdentifiableFastSRM.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subjects_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.identifiable_srm.IdentifiableFastSRM.transform" title="Permalink to this definition"></a></dt>
<dd><p>From data in imgs and basis from training data,
computes shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None:</em>) – if None imgs[i] will be transformed using basis_list[i]. Otherwise imgs[i] will be transformed using basis[subjects_index[i]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>shared_response</strong> –</p>
<ul class="simple">
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays, list of list of arrays or array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="fastsrm-detsrm-and-probsrm">
<h1>FastSRM, DetSRM and ProbSRM<a class="headerlink" href="#fastsrm-detsrm-and-probsrm" title="Permalink to this headline"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="fastsrm.fastsrm.fastsrm">
<span class="sig-prename descclassname"><span class="pre">fastsrm.fastsrm.</span></span><span class="sig-name descname"><span class="pre">fastsrm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prob'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.fastsrm.fastsrm" title="Permalink to this definition"></a></dt>
<dd><p>Performs an SRM decomposition on
input data with a number of features
much larger than the number of samples:
Reduces the data by PCA and apply an SRM
algorithm one reduced data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1
imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.
imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of timecourses of the shared coordinates</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – The number of CPUs to use to do the computation. -1 means all CPUs, -2 all CPUs but one, and so on.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> or </em><em>&quot;warn&quot;</em>) – If True, logs are enabled. If False, logs are disabled. If “warn” only warnings are printed.</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) – Number of iterations to perform</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Stops if the norm of the gradient falls below tolerance value</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default=&quot;prob&quot;</em>) – if “prob”, uses Probabilistic SRM
if “det”, uses Deterministic SRM</p></li>
<li><p><strong>temp_dir</strong> (<em>str</em><em> or </em><em>None</em>) – Path to dir where temporary results are stored. If None temporary results will be stored in memory. This can results in memory errors when the number of subjects and/or sessions is large</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>RandomState instance</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Controls the randomness of the initialization.</p></li>
<li><p><strong>callback</strong> (<em>function</em><em> or </em><em>None</em>) – At each iteration calls callback(S, gnorm, it, t0) where <cite>S</cite> is the
current estimate of the shared response, <cite>gnorm</cite> is the current
<cite>gradient norm</cite>, <cite>it</cite> is the current iteration and <cite>t0</cite> the current
time. The result is saved in a list <cite>record</cite>.
If callback is None, nothing is done.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>W</strong> (<em>list of n_subjects numpy array of shape (n_voxels, n_components)         or path to np array of shape (n_voxels, n_components)</em>) – Subject specific basis</p></li>
<li><p><strong>S</strong> (<em>np array of shape (n_components, n_timeframes)</em>) – Shared response</p></li>
<li><p><strong>sigmas</strong> (<em>np array of shape (n_subjects,)</em>) – Noise variance (only returned if method == “probsrm”)</p></li>
<li><p><strong>Sigma</strong> (<em>np array of shape (n_components,)</em>) – (Diagonal) source covariance         (only returned if method == “probsrm”)</p></li>
<li><p><strong>records</strong> (<em>list of shape (n_iter,)</em>) – The recorded information from callback.
Only returned if callback is not None</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fastsrm.srm.detsrm">
<span class="sig-prename descclassname"><span class="pre">fastsrm.srm.</span></span><span class="sig-name descname"><span class="pre">detsrm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.srm.detsrm" title="Permalink to this definition"></a></dt>
<dd><p>Perform Deterministic SRM on numpy arrays.
To be used when data hold in memory and the number
of features is not much larger than the number
of samples (in which case fastsrm is preferable)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np array of shape</em><em> (</em><em>n_views</em><em>, </em><em>n_features</em><em>, </em><em>n_samples</em><em>)</em>) – Input data</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of timecourses of the shared coordinates</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) – Number of iterations to perform</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>RandomState instance</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Controls the randomness of the initialization.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, logs are enabled. If False, logs are disabled.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Stops if the norm of the gradient falls below tolerance value</p></li>
<li><p><strong>callback</strong> (<em>function</em><em> or </em><em>None</em>) – At each iteration calls callback(S, gnorm, it, t0) where <cite>S</cite> is the
current estimate of the shared response, <cite>gnorm</cite> is the current
<cite>gradient norm</cite>, <cite>it</cite> is the current iteration and <cite>t0</cite> the current
time. The result is saved in a list <cite>record</cite>.
If callback is None, nothing is done.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>W</strong> (<em>np array of shape     (n_views, n_features, n_components)</em>) – Subject specific basis</p></li>
<li><p><strong>S</strong> (<em>np array of shape (n_components, n_timeframes)</em>) – Shared response</p></li>
<li><p><strong>records</strong> (<em>list of shape (n_iter,)</em>) – The recorded information from callback.
Only returned if callback is not None</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fastsrm.srm.probsrm">
<span class="sig-prename descclassname"><span class="pre">fastsrm.srm.</span></span><span class="sig-name descname"><span class="pre">probsrm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrective_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastsrm.srm.probsrm" title="Permalink to this definition"></a></dt>
<dd><p>Perform Probabilistic SRM on numpy arrays.
To be used when data hold in memory and the number
of features is not much larger than the number
of samples (in which case fastsrm is preferable)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np array of shape</em><em> (</em><em>n_views</em><em>, </em><em>n_features</em><em>, </em><em>n_samples</em><em>)</em>) – Input data</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of timecourses of the shared coordinates</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) – Number of iterations to perform</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>RandomState instance</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Controls the randomness of the initialization.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, logs are enabled. If False, logs are disabled.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Stops if the norm of the gradient falls below tolerance value</p></li>
<li><p><strong>callback</strong> (<em>function</em><em> or </em><em>None</em>) – At each iteration calls callback(S, gnorm, it, t0) where <cite>S</cite> is the
current estimate of the shared response, <cite>gnorm</cite> is the current
<cite>gradient norm</cite>, <cite>it</cite> is the current iteration and <cite>t0</cite> the current
time. The result is saved in a list <cite>record</cite>.
If callback is None, nothing is done.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>W</strong> (<em>np array of shape     (n_views, n_features, n_components)</em>) – Subject specific basis</p></li>
<li><p><strong>S</strong> (<em>np array of shape (n_components, n_timeframes)</em>) – Shared response</p></li>
<li><p><strong>sigmas</strong> (<em>np array of shape (n_views,)</em>) – Noise variance</p></li>
<li><p><strong>Sigma</strong> (<em>np array of shape (n_components,)</em>) – (Diagonal) Shared response covariance</p></li>
<li><p><strong>records</strong> (<em>list of shape (n_iter,)</em>) – The recorded information from callback.
Only returned if callback is not None</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="auto_examples/plot_synthetic_toy.html" class="btn btn-neutral float-right" title="FastSRM : running time and convergence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Hugo RICHARD.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>